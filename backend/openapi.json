{"openapi":"3.0.3","info":{"title":"WebGuard API","description":"WebGuard - 域名监控服务 API 文档","contact":{"name":"WebGuard Team"},"license":{"name":""},"version":"1.0.0"},"paths":{"/api/auth/login":{"post":{"tags":["认证"],"summary":"Login","operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequestJson"}}},"required":true},"responses":{"200":{"description":"登录成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}},"401":{"description":"认证失败","content":{"application/json":{"schema":{"$ref":"#/components/schemas/crate.error.ErrorResponse"}}}}}}},"/api/auth/refresh":{"post":{"tags":["认证"],"summary":"Refresh access token","operationId":"refresh_token","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshTokenRequest"}}},"required":true},"responses":{"200":{"description":"刷新成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}},"401":{"description":"刷新令牌无效或已过期","content":{"application/json":{"schema":{"$ref":"#/components/schemas/crate.error.ErrorResponse"}}}}}}},"/api/auth/register":{"post":{"tags":["认证"],"summary":"Register a new user","operationId":"register","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterRequestJson"}}},"required":true},"responses":{"201":{"description":"注册成功","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponse"}}}},"400":{"description":"请求参数错误","content":{"application/json":{"schema":{"$ref":"#/components/schemas/crate.error.ErrorResponse"}}}}}}},"/api/domains":{"get":{"tags":["域名"],"summary":"List domains for an organization","operationId":"list_domains","parameters":[{"name":"org_id","in":"query","description":"组织ID（可选，默认使用用户的默认组织）","required":false,"schema":{"type":"string","format":"uuid","nullable":true}}],"responses":{"200":{"description":"获取成功"},"401":{"description":"未授权"},"403":{"description":"不是组织成员"}},"security":[{"BearerAuth":[]}]},"post":{"tags":["域名"],"summary":"Create a new domain","operationId":"create_domain","parameters":[{"name":"org_id","in":"query","description":"组织ID（可选，默认使用用户的默认组织）","required":false,"schema":{"type":"string","format":"uuid","nullable":true}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateDomainRequest"}}},"required":true},"responses":{"201":{"description":"创建成功，自动创建 SSL 和 Uptime 监控器"},"400":{"description":"请求参数错误"},"401":{"description":"未授权"},"403":{"description":"无权限创建域名"}},"security":[{"BearerAuth":[]}]}},"/api/domains/{id}":{"get":{"tags":["域名"],"summary":"Get domain by ID","operationId":"get_domain","parameters":[{"name":"id","in":"path","description":"域名ID","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"获取成功"},"401":{"description":"未授权"},"403":{"description":"不是组织成员"},"404":{"description":"域名不存在"}},"security":[{"BearerAuth":[]}]},"put":{"tags":["域名"],"summary":"Update domain","operationId":"update_domain","parameters":[{"name":"id","in":"path","description":"域名ID","required":true,"schema":{"type":"string","format":"uuid"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateDomainRequest"}}},"required":true},"responses":{"200":{"description":"更新成功"},"401":{"description":"未授权"},"403":{"description":"无权限更新域名"},"404":{"description":"域名不存在"}},"security":[{"BearerAuth":[]}]},"delete":{"tags":["域名"],"summary":"Delete domain","operationId":"delete_domain","parameters":[{"name":"id","in":"path","description":"域名ID","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"204":{"description":"删除成功"},"401":{"description":"未授权"},"403":{"description":"无权限删除域名"},"404":{"description":"域名不存在"}},"security":[{"BearerAuth":[]}]}},"/api/organizations":{"get":{"tags":["组织"],"summary":"List user's organizations","operationId":"list_organizations","responses":{"200":{"description":"获取成功"},"401":{"description":"未授权"}},"security":[{"BearerAuth":[]}]},"post":{"tags":["组织"],"summary":"Create a new organization","operationId":"create_organization","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateOrganizationRequest"}}},"required":true},"responses":{"201":{"description":"创建成功"},"400":{"description":"请求参数错误"},"401":{"description":"未授权"}},"security":[{"BearerAuth":[]}]}},"/api/organizations/{id}":{"get":{"tags":["组织"],"summary":"Get organization by ID","operationId":"get_organization","parameters":[{"name":"id","in":"path","description":"组织ID","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"获取成功"},"401":{"description":"未授权"},"403":{"description":"无权限访问该组织"},"404":{"description":"组织不存在"}},"security":[{"BearerAuth":[]}]},"put":{"tags":["组织"],"summary":"Update organization","operationId":"update_organization","parameters":[{"name":"id","in":"path","description":"组织ID","required":true,"schema":{"type":"string","format":"uuid"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateOrganizationRequest"}}},"required":true},"responses":{"200":{"description":"更新成功"},"401":{"description":"未授权"},"403":{"description":"无权限更新组织"}},"security":[{"BearerAuth":[]}]},"delete":{"tags":["组织"],"summary":"Delete organization","operationId":"delete_organization","parameters":[{"name":"id","in":"path","description":"组织ID","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"204":{"description":"删除成功"},"401":{"description":"未授权"},"403":{"description":"无权限删除组织"}},"security":[{"BearerAuth":[]}]}},"/api/organizations/{id}/members":{"get":{"tags":["组织"],"summary":"List organization members","operationId":"list_members","parameters":[{"name":"id","in":"path","description":"组织ID","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"200":{"description":"获取成功"},"401":{"description":"未授权"},"403":{"description":"不是组织成员"}},"security":[{"BearerAuth":[]}]},"post":{"tags":["组织"],"summary":"Add member to organization","operationId":"add_member","parameters":[{"name":"id","in":"path","description":"组织ID","required":true,"schema":{"type":"string","format":"uuid"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AddMemberRequest"}}},"required":true},"responses":{"201":{"description":"添加成功"},"400":{"description":"用户已是成员或不存在"},"401":{"description":"未授权"},"403":{"description":"无权限添加成员"}},"security":[{"BearerAuth":[]}]}},"/api/organizations/{id}/members/{user_id}":{"delete":{"tags":["组织"],"summary":"Remove member from organization","operationId":"remove_member","parameters":[{"name":"id","in":"path","description":"组织ID","required":true,"schema":{"type":"string","format":"uuid"}},{"name":"user_id","in":"path","description":"用户ID","required":true,"schema":{"type":"string","format":"uuid"}}],"responses":{"204":{"description":"移除成功"},"400":{"description":"无法移除组织所有者"},"401":{"description":"未授权"},"403":{"description":"无权限移除成员"}},"security":[{"BearerAuth":[]}]}},"/api/organizations/{id}/members/{user_id}/role":{"put":{"tags":["组织"],"summary":"Update member role","operationId":"update_member_role","parameters":[{"name":"id","in":"path","description":"组织ID","required":true,"schema":{"type":"string","format":"uuid"}},{"name":"user_id","in":"path","description":"用户ID","required":true,"schema":{"type":"string","format":"uuid"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateMemberRoleRequest"}}},"required":true},"responses":{"204":{"description":"更新成功"},"400":{"description":"无法修改所有者角色"},"401":{"description":"未授权"},"403":{"description":"无权限修改角色"}},"security":[{"BearerAuth":[]}]}},"/health":{"get":{"tags":["认证"],"summary":"Health check endpoint","operationId":"health_check","responses":{"200":{"description":"服务正常"}}}}},"components":{"schemas":{"AddMemberRequest":{"type":"object","required":["email","role"],"properties":{"email":{"type":"string"},"role":{"$ref":"#/components/schemas/MemberRole"}}},"AuthResponse":{"type":"object","required":["access_token","refresh_token","user"],"properties":{"access_token":{"type":"string"},"refresh_token":{"type":"string"},"user":{"$ref":"#/components/schemas/UserResponse"}}},"CreateDomainRequest":{"type":"object","required":["name"],"properties":{"name":{"type":"string"}}},"CreateOrganizationRequest":{"type":"object","required":["name"],"properties":{"name":{"type":"string"},"slug":{"type":"string","nullable":true}}},"Domain":{"type":"object","description":"Domain being monitored","required":["id","organization_id","name","normalized_name","created_at","updated_at","is_active"],"properties":{"created_at":{"type":"string","format":"date-time"},"id":{"type":"string","format":"uuid"},"is_active":{"type":"boolean"},"name":{"type":"string"},"normalized_name":{"type":"string"},"organization_id":{"type":"string","format":"uuid"},"updated_at":{"type":"string","format":"date-time"}}},"DomainQueryParams":{"type":"object","description":"Query parameters for domain endpoints","properties":{"org_id":{"type":"string","format":"uuid","nullable":true}}},"ErrorResponse":{"type":"object","description":"Error response structure for API documentation","required":["code","message"],"properties":{"code":{"type":"string"},"details":{"type":"object","additionalProperties":{"type":"string"},"nullable":true},"message":{"type":"string"}}},"LoginRequestJson":{"type":"object","required":["email","password"],"properties":{"email":{"type":"string"},"password":{"type":"string"}}},"MemberRole":{"type":"string","description":"Member role in an organization","enum":["Owner","Admin","Member","Viewer"]},"Organization":{"type":"object","description":"Organization (team)","required":["id","name","slug","created_at","updated_at","max_monitors"],"properties":{"created_at":{"type":"string","format":"date-time"},"id":{"type":"string","format":"uuid"},"max_monitors":{"type":"integer","format":"int32"},"name":{"type":"string"},"slug":{"type":"string"},"updated_at":{"type":"string","format":"date-time"},"webhook_url":{"type":"string","nullable":true}}},"OrganizationMember":{"type":"object","description":"Organization member with role","required":["id","organization_id","user_id","role","created_at"],"properties":{"created_at":{"type":"string","format":"date-time"},"id":{"type":"string","format":"uuid"},"organization_id":{"type":"string","format":"uuid"},"role":{"$ref":"#/components/schemas/MemberRole"},"user_id":{"type":"string","format":"uuid"}}},"RefreshTokenRequest":{"type":"object","required":["refresh_token"],"properties":{"refresh_token":{"type":"string"}}},"RegisterRequestJson":{"type":"object","description":"Request/response types for auth endpoints","required":["email","password"],"properties":{"email":{"type":"string"},"full_name":{"type":"string","nullable":true},"password":{"type":"string"}}},"UpdateDomainRequest":{"type":"object","properties":{"is_active":{"type":"boolean","nullable":true}}},"UpdateMemberRoleRequest":{"type":"object","required":["role"],"properties":{"role":{"$ref":"#/components/schemas/MemberRole"}}},"UpdateOrganizationRequest":{"type":"object","properties":{"name":{"type":"string","nullable":true},"webhook_url":{"type":"string","nullable":true}}},"UserResponse":{"type":"object","required":["id","email","created_at"],"properties":{"created_at":{"type":"string"},"email":{"type":"string"},"full_name":{"type":"string","nullable":true},"id":{"type":"string","format":"uuid"},"last_login_at":{"type":"string","nullable":true}}}},"securitySchemes":{"BearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT","description":"JWT 访问令牌认证"}}},"tags":[{"name":"认证","description":"用户认证相关接口"},{"name":"组织","description":"组织管理相关接口"},{"name":"域名","description":"域名监控相关接口"}]}